

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Adding new features &mdash; skyportal 0.9.dev0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/output_cells.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="How to Contribute" href="contributing.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> skyportal
          

          
          </a>

          
            
            
              <div class="version">
                0.9.dev0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="setup.html">Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev.html">Developer notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="deploy.html">Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">How to Contribute</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Adding new features</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#front-end-overview-react-redux">Front-end overview: React &amp; Redux</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#basic-react-concepts-elements-and-components">Basic React concepts: Elements and Components</a></li>
<li class="toctree-l3"><a class="reference internal" href="#component-state">Component state</a></li>
<li class="toctree-l3"><a class="reference internal" href="#redux-basics">Redux basics</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#adding-a-new-end-to-end-skyportal-feature">Adding a new end-to-end SkyPortal feature</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#front-end">Front-end</a></li>
<li class="toctree-l3"><a class="reference internal" href="#back-end">Back-end</a></li>
<li class="toctree-l3"><a class="reference internal" href="#websockets">Websockets</a></li>
<li class="toctree-l3"><a class="reference internal" href="#file-creation-edit-bookkeeping">File creation/edit bookkeeping</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#summary-of-front-end-data-flow">Summary of front-end data flow</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">skyportal</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Adding new features</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="adding-new-features">
<h1>Adding new features<a class="headerlink" href="#adding-new-features" title="Permalink to this headline">¶</a></h1>
<p>This section will help you get started adding new features to SkyPortal. We’ll discuss the application structure and data flow, and introduce some of the main technologies that are employed, outlining their basic usage. We’ll dig into the code base by walking through the process of adding a simple new feature: a button that triggers an API call to the back-end, which generates a random string that is displayed in the browser.</p>
<div class="section" id="front-end-overview-react-redux">
<h2>Front-end overview: React &amp; Redux<a class="headerlink" href="#front-end-overview-react-redux" title="Permalink to this headline">¶</a></h2>
<p>The SkyPortal front-end uses React, a component-based UI library, in conjunction with Redux, a front-end state-management library. See the following links for introductory tutorials to these and related libraries, from which much of the below is drawn:</p>
<p><a class="reference external" href="https://reactjs.org/tutorial/tutorial.html">ReactJS Tutorial</a></p>
<p><a class="reference external" href="https://reactjs.org/docs/hooks-overview.html">ReactJS Hooks Overview</a></p>
<p><a class="reference external" href="https://redux.js.org/basics/basic-tutorial/">Redux Tutorial</a></p>
<p><a class="reference external" href="https://react-redux.js.org/next/api/hooks">React-Redux Hooks Intro</a></p>
<div class="section" id="basic-react-concepts-elements-and-components">
<h3>Basic React concepts: Elements and Components<a class="headerlink" href="#basic-react-concepts-elements-and-components" title="Permalink to this headline">¶</a></h3>
<p>In React, <a class="reference external" href="https://reactjs.org/docs/rendering-elements.html"><em>elements</em></a> are the smallest building blocks of an app and correspond to DOM elements, but are simple JavaScript objects that are cheap to create. Elements describe what should be displayed in the browser. Here’s a simple example of an element (written with a <a class="reference external" href="https://reactjs.org/docs/introducing-jsx.html">JSX</a> tag):</p>
<div class="highlight-jsx notranslate"><div class="highlight"><pre><span></span><span class="kr">const</span> <span class="nx">element</span> <span class="o">=</span> <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="nx">Hello</span><span class="p">,</span> <span class="nx">world</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;;</span>
</pre></div>
</div>
<p><a class="reference external" href="https://reactjs.org/docs/components-and-props.html"><em>Components</em></a> are essentially pure JavaScript functions that take inputs (called “props”) and return elements. Let’s look at a simple example:</p>
<div class="highlight-jsx notranslate"><div class="highlight"><pre><span></span><span class="kr">const</span> <span class="nx">Component</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="nx">Hello</span><span class="p">,</span> <span class="nx">world</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;;</span>
<span class="p">};</span>
</pre></div>
</div>
<p>As you can see, our component is simply a function (written above as an ES6 <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions">arrow function</a>) that returns an element. If arrow functions look unfamiliar, the above component definition is equivalent to:</p>
<div class="highlight-jsx notranslate"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">Component</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="nx">Hello</span><span class="p">,</span> <span class="nx">world</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Components can be defined as classes or functions, but in this tutorial we’ll always use the functional form. As noted above, components can take inputs, called props. Let’s take a look at a simple component that takes a single “props” argument <code class="docutils literal notranslate"><span class="pre">name</span></code>:</p>
<div class="highlight-jsx notranslate"><div class="highlight"><pre><span></span><span class="kr">const</span> <span class="nx">Component</span> <span class="o">=</span> <span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">(</span>
    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>
      <span class="nx">Hello</span><span class="p">,</span> <span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span>
    <span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
  <span class="p">);</span>
<span class="p">};</span>
</pre></div>
</div>
<p>This component returns an element, that, when rendered into the DOM (more on this below), displays a header containing the text “Hello, Maria” (assuming we passed in <code class="docutils literal notranslate"><span class="pre">name='Maria'</span></code>). Inside <a class="reference external" href="https://reactjs.org/docs/introducing-jsx.html">JSX</a> tags, JavaScript expressions must be wrapped in curly braces, as <code class="docutils literal notranslate"><span class="pre">props.name</span></code> is above. If we instantiate this component and pass in the value ‘world’ to the <code class="docutils literal notranslate"><span class="pre">name</span></code> prop, the resulting value is identical to the first element we defined above:</p>
<div class="highlight-jsx notranslate"><div class="highlight"><pre><span></span><span class="kr">const</span> <span class="nx">helloWorldElement</span> <span class="o">=</span> <span class="p">&lt;</span><span class="nt">Component</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;world&quot;</span> <span class="p">/&gt;;</span>
</pre></div>
</div>
<p>is identical to:</p>
<div class="highlight-jsx notranslate"><div class="highlight"><pre><span></span><span class="kr">const</span> <span class="nx">helloWorldElement</span> <span class="o">=</span> <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="nx">Hello</span><span class="p">,</span> <span class="nx">world</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;;</span>
</pre></div>
</div>
<p>Note that React component names should always be capitalized, as React looks for this to distinguish component tags (e.g. <code class="docutils literal notranslate"><span class="pre">&lt;Component</span> <span class="pre">/&gt;</span></code>) from DOM tags (e.g. <code class="docutils literal notranslate"><span class="pre">&lt;div&gt;...&lt;/div&gt;</span></code>).</p>
<p>Now we know a bit about React elements and components, but we still haven’t actually rendered anything into the DOM. To render a React element into a DOM node, we pass both into <code class="docutils literal notranslate"><span class="pre">ReactDOM.render()</span></code> Let’s look at a full example:</p>
<div class="highlight-jsx notranslate"><div class="highlight"><pre><span></span><span class="kr">import</span> <span class="nx">React</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">ReactDOM</span> <span class="nx">from</span> <span class="s1">&#39;react-dom&#39;</span><span class="p">;</span>


<span class="c1">// Define our component:</span>
<span class="kr">const</span> <span class="nx">Component</span> <span class="o">=</span> <span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">(</span>
  <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>
    <span class="nx">Hello</span><span class="p">,</span> <span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span>
  <span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<span class="p">);</span>

<span class="c1">// Render the element it returns into the DOM (into the DOM element with ID &quot;root&quot;):</span>
<span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(&lt;</span><span class="nt">Component</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;world&quot;</span> <span class="p">/&gt;,</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;root&quot;</span><span class="p">));</span>
</pre></div>
</div>
<p>We define our component, then pass an instance of that component (which evaluates to a React element) as the first argument to <code class="docutils literal notranslate"><span class="pre">ReactDOM.render()</span></code>, and pass the DOM element that we want to render our element into as the second argument. (Note that in the above component definition, we’re using an <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions#Function_body">arrow function with a “concise body” implicit return</a>.)</p>
<p>Components can also render other components, as in the following example:</p>
<div class="highlight-jsx notranslate"><div class="highlight"><pre><span></span><span class="kr">const</span> <span class="nx">Welcome</span> <span class="o">=</span> <span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">(</span>
  <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="nx">Welcome</span><span class="p">,</span> <span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">name</span><span class="p">}&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<span class="p">);</span>

<span class="kr">const</span> <span class="nx">HomePage</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">(</span>
  <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">Welcome</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;Maria&quot;</span> <span class="p">/&gt;</span>
    <span class="p">&lt;</span><span class="nt">Welcome</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;Sofia&quot;</span> <span class="p">/&gt;</span>
    <span class="p">&lt;</span><span class="nt">Welcome</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;Li&quot;</span> <span class="p">/&gt;</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">);</span>

<span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(&lt;</span><span class="nt">HomePage</span> <span class="p">/&gt;,</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;root&quot;</span><span class="p">));</span>
</pre></div>
</div>
<p>This renders a <code class="docutils literal notranslate"><span class="pre">div</span></code> containing our three welcome headers into the DOM element whose ID is “root”.</p>
</div>
<div class="section" id="component-state">
<h3>Component state<a class="headerlink" href="#component-state" title="Permalink to this headline">¶</a></h3>
<p>Components can have their own internal state, independent of the props that are passed into them. To illustrate, let’s create a component that tracks how many times a button has been clicked, and displays the count.</p>
<p>For functional components, we use React’s <a class="reference external" href="https://reactjs.org/docs/hooks-overview.html"><code class="docutils literal notranslate"><span class="pre">useState</span></code> hook</a> to create a state object and a function that updates it. Let’s first just define a component with some state that displays the value of that state:</p>
<div class="highlight-jsx notranslate"><div class="highlight"><pre><span></span><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">useState</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>


<span class="kr">const</span> <span class="nx">Counter</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="p">[</span><span class="nx">count</span><span class="p">,</span> <span class="nx">updateCount</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

   <span class="k">return</span> <span class="p">(</span>
     <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
       <span class="nx">Current</span> <span class="nx">count</span><span class="o">:</span> <span class="p">{</span><span class="nx">count</span><span class="p">}</span>
     <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
  <span class="p">);</span>
<span class="p">};</span>
</pre></div>
</div>
<p>We pass in <code class="docutils literal notranslate"><span class="pre">0</span></code> as the default value to <code class="docutils literal notranslate"><span class="pre">useState</span></code>, which returns a tuple containing our state object (which we’ve called <code class="docutils literal notranslate"><span class="pre">count</span></code>) and a function that can update that state (which we’ve called <code class="docutils literal notranslate"><span class="pre">updateCount</span></code>). So now we have a component that has its own state and displays that value in a <code class="docutils literal notranslate"><span class="pre">div</span></code>, but that isn’t very useful because we have no way of interacting with it to update that value. Let’s define a handler to update the count, add a button, and pass our handler to the <code class="docutils literal notranslate"><span class="pre">onClick</span></code> event in the button:</p>
<div class="highlight-jsx notranslate"><div class="highlight"><pre><span></span><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">useState</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>


<span class="kr">const</span> <span class="nx">Counter</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="p">[</span><span class="nx">count</span><span class="p">,</span> <span class="nx">updateCount</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

  <span class="kr">const</span> <span class="nx">handleClick</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">newCount</span> <span class="o">=</span> <span class="nx">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
    <span class="nx">updateCount</span><span class="p">(</span><span class="nx">newCount</span><span class="p">);</span>
  <span class="p">};</span>

   <span class="k">return</span> <span class="p">(</span>
     <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
       <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
         <span class="nx">Current</span> <span class="nx">count</span><span class="o">:</span> <span class="p">{</span><span class="nx">count</span><span class="p">}</span>
       <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
       <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
         <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;button&quot;</span> <span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">handleClick</span><span class="p">}&gt;</span>
           <span class="nx">Increment</span><span class="o">!</span>
         <span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
       <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
     <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
  <span class="p">);</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Let’s look at what’s happening here: we’ve defined a new function in our component called <code class="docutils literal notranslate"><span class="pre">handleClick</span></code> that increments the value of our <code class="docutils literal notranslate"><span class="pre">count</span></code> state by 1, and have passed that as a callback to the button’s <code class="docutils literal notranslate"><span class="pre">onClick</span></code> event. Now every time we click the button, <code class="docutils literal notranslate"><span class="pre">handleClick</span></code> will be executed which will increment the value of <code class="docutils literal notranslate"><span class="pre">count</span></code> by 1. React tracks whenever a component’s props or state are updated, and updates the elements being rendered into the DOM accordingly. Great, our first interactive component with its own state is working! Now that we’ve learned some of the basics of React, let’s take a look at Redux, another front-end library employed in our application.</p>
</div>
<div class="section" id="redux-basics">
<h3>Redux basics<a class="headerlink" href="#redux-basics" title="Permalink to this headline">¶</a></h3>
<p>We use <a class="reference external" href="https://redux.js.org/basics/basic-tutorial/">Redux</a> to store and manage global front-end state. The basic idea is simple: Redux provides a global <code class="docutils literal notranslate"><span class="pre">store</span></code> object that contains the application state and allows that state to be updated via the dispatching of <em>actions</em>. Actions are simply objects with a <code class="docutils literal notranslate"><span class="pre">type</span></code> attribute and may contain a payload, e.g. <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">type:</span> <span class="pre">'UPDATE_SOURCES',</span> <span class="pre">data:</span> <span class="pre">{</span> <span class="pre">sourceList:</span> <span class="pre">[{</span> <span class="pre">id:</span> <span class="pre">'14gqr',</span> <span class="pre">...</span> <span class="pre">},</span> <span class="pre">...]</span> <span class="pre">}}</span></code>. We dispatch actions via the Redux function <code class="docutils literal notranslate"><span class="pre">store.dispatch</span></code>, and these actions are handled by <em>reducers</em> which specify how the application state should be updated in response to actions dispatched to the store. Let’s take a look at an example of creating actions and reducers:</p>
<div class="highlight-jsx notranslate"><div class="highlight"><pre><span></span><span class="c1">// Define our action type:</span>
<span class="kr">const</span> <span class="nx">UPDATE_SOURCES</span> <span class="o">=</span> <span class="s2">&quot;UPDATE_SOURCES&quot;</span><span class="p">;</span>

<span class="c1">// Define our reducer:</span>
<span class="kr">const</span> <span class="nx">reducer</span> <span class="o">=</span> <span class="p">(</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">sourceList</span><span class="o">:</span> <span class="p">[]</span> <span class="p">},</span> <span class="nx">action</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="k">switch</span> <span class="p">(</span><span class="nx">action</span><span class="p">.</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">case</span> <span class="nx">UPDATE_SOURCES</span><span class="o">:</span> <span class="p">{</span>
      <span class="kr">const</span> <span class="p">{</span> <span class="nx">sourceList</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">action</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>  <span class="c1">// Object destructuring assignment</span>
      <span class="k">return</span> <span class="p">{</span>
        <span class="p">...</span><span class="nx">state</span><span class="p">,</span>  <span class="c1">// Object spread operator</span>
        <span class="nx">sourceList</span>  <span class="c1">// Object literal property shorthand</span>
      <span class="p">};</span>
    <span class="p">}</span>
    <span class="k">default</span><span class="o">:</span>
      <span class="k">return</span> <span class="nx">state</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span>
</pre></div>
</div>
<p>(If the above JavaScript syntax is unfamiliar, please refer to the <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment">object destructuring assignment docs</a>, <a class="reference external" href="https://tc39.es/proposal-object-rest-spread/">object spread syntax docs</a>, and a description here of <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Object_initializer">object literal property shorthand</a>.) Let’s break this down: we’ve defined our action type, which is just a string literal, and assigned its value to the constant <code class="docutils literal notranslate"><span class="pre">UPDATE_SOURCES</span></code>. We also defined a reducer (the function named <code class="docutils literal notranslate"><span class="pre">reducer</span></code>) which takes two arguments: <code class="docutils literal notranslate"><span class="pre">state</span></code>, the current state value (which we’ve given a default value of <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">sourceList:</span> <span class="pre">[]</span> <span class="pre">}</span></code> here) and <code class="docutils literal notranslate"><span class="pre">action</span></code>, the action object that has been dispatched to the store. Our reducer then returns a new object based on the previous state and the data contained in <code class="docutils literal notranslate"><span class="pre">action</span></code>. As you can see, the original state is return with no changes by default, which is the case whenever an action whose type doesn’t match any of the cases we’ve described in our reducer. <em>Reducers are pure functions that take the current state and an action as arguments, and return a new state object</em>. Whenever an action is dispatched, each of the reducers in the store is called, with the current state and the action passed in as arguments, and only those reducers whose cases  a matching action type will return a modified state object.</p>
<p>In SkyPortal, we’ve added a utility method to the global <code class="docutils literal notranslate"><span class="pre">store</span></code> object to inject reducers to the store. Each reducer corresponds to its own branch of the state tree, which is specified when we inject the reducer into the store. Let’s look at an example, assuming we’re creating new a file in the <code class="docutils literal notranslate"><span class="pre">static/js/ducks</span></code> directory (our <code class="docutils literal notranslate"><span class="pre">store</span></code> is defined in <code class="docutils literal notranslate"><span class="pre">static/js/store.js</span></code>):</p>
<div class="highlight-jsx notranslate"><div class="highlight"><pre><span></span><span class="kr">import</span> <span class="nx">store</span> <span class="nx">from</span> <span class="s1">&#39;../store&#39;</span><span class="p">;</span>


<span class="c1">// Define our action type:</span>
<span class="kr">const</span> <span class="nx">UPDATE_SOURCES</span> <span class="o">=</span> <span class="s2">&quot;UPDATE_SOURCES&quot;</span><span class="p">;</span>

<span class="c1">// Define our reducer:</span>
<span class="kr">const</span> <span class="nx">reducer</span> <span class="o">=</span> <span class="p">(</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">sourceList</span><span class="o">:</span> <span class="p">[]</span> <span class="p">},</span> <span class="nx">action</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="k">switch</span> <span class="p">(</span><span class="nx">action</span><span class="p">.</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">case</span> <span class="nx">UPDATE_SOURCES</span><span class="o">:</span> <span class="p">{</span>
      <span class="kr">const</span> <span class="p">{</span> <span class="nx">sourceList</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">action</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>
      <span class="k">return</span> <span class="p">{</span>
        <span class="p">...</span><span class="nx">state</span><span class="p">,</span>
        <span class="nx">sourceList</span>
      <span class="p">};</span>
    <span class="p">}</span>
    <span class="k">default</span><span class="o">:</span>
      <span class="k">return</span> <span class="nx">state</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="c1">// Inject our reducer into the store, mapping it to the &#39;sources&#39; state branch:</span>
<span class="nx">store</span><span class="p">.</span><span class="nx">injectReducer</span><span class="p">(</span><span class="s1">&#39;sources&#39;</span><span class="p">,</span> <span class="nx">reducer</span><span class="p">);</span>
</pre></div>
</div>
<p>This warrants a brief note on code organization: we bundle all of our Redux-related code (action types, action creators, reducer) associated with a particular branch of the application state together in a file in the <code class="docutils literal notranslate"><span class="pre">static/js/ducks</span></code> directory (<a class="reference external" href="https://github.com/erikras/ducks-modular-redux">read more about “ducks” modules here</a>). Each component definition typically goes in its own file in <code class="docutils literal notranslate"><span class="pre">static/js/components</span></code>.</p>
<p>Now that we’ve added our reducer to the store, whenever an action of type <code class="docutils literal notranslate"><span class="pre">UPDATE_SOURCES</span></code> is dispatched, our reducer will update the <code class="docutils literal notranslate"><span class="pre">sources</span></code> branch of the application state as specified. So far, our global application state looks like: <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">sources:</span> <span class="pre">{</span> <span class="pre">sourceList:</span> <span class="pre">...}</span> <span class="pre">}</span></code>.</p>
<p>We have injected our reducer into the store that can handle actions of the type <code class="docutils literal notranslate"><span class="pre">UPDATE_SOURCES</span></code>, so now let’s dispatch one. We use the <code class="docutils literal notranslate"><span class="pre">react-redux</span></code> library which provides a <code class="docutils literal notranslate"><span class="pre">useDispatch</span></code> function, giving us access to the store’s dispatch. Dispatching an action is as simple as:</p>
<div class="highlight-jsx notranslate"><div class="highlight"><pre><span></span><span class="kr">import</span> <span class="p">{</span> <span class="nx">useDispatch</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react-redux&#39;</span><span class="p">;</span>


<span class="kr">const</span> <span class="nx">dispatch</span> <span class="o">=</span> <span class="nx">useDispatch</span><span class="p">();</span>

<span class="kr">const</span> <span class="nx">newSourceList</span> <span class="o">=</span> <span class="nx">resultFromSomeAPICall</span><span class="p">();</span>

<span class="nx">dispatch</span><span class="p">({</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;UPDATE_SOURCES&#39;</span><span class="p">,</span> <span class="nx">data</span><span class="o">:</span> <span class="p">{</span> <span class="nx">sourceList</span><span class="o">:</span> <span class="nx">newSourceList</span> <span class="p">}</span> <span class="p">});</span>
</pre></div>
</div>
<p>The store dispatches the action, and applies each of our reducers to it, creating a new state object from the return values of our reducers (each reducer returning the branch of state it’s associated with, e.g. the return value of the reducer above corresponds to the ‘sources’ branch, or <code class="docutils literal notranslate"><span class="pre">state.sources</span></code>, as specified in our <code class="docutils literal notranslate"><span class="pre">store.injectRecuer</span></code> call). Typically we define <em>action creators</em>, functions that return action objects, and call those inside <code class="docutils literal notranslate"><span class="pre">dispatch</span></code> rather than explicitly pass in these clunky action objects everytime we need to dispatch an action. Here’s an example of an action creator being defined, and then using it to dispatch an action:</p>
<div class="highlight-jsx notranslate"><div class="highlight"><pre><span></span><span class="c1">// Define action creator</span>
<span class="kr">const</span> <span class="nx">updateSources</span> <span class="o">=</span> <span class="p">(</span><span class="nx">newSourceList</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;UPDATE_SOURCES&#39;</span><span class="p">,</span> <span class="nx">data</span><span class="o">:</span> <span class="p">{</span> <span class="nx">sourceList</span><span class="o">:</span> <span class="nx">newSourceList</span> <span class="p">}</span> <span class="p">};</span>
<span class="p">};</span>

<span class="c1">// Get some data</span>
<span class="kr">const</span> <span class="nx">newSourceList</span> <span class="o">=</span> <span class="nx">resultFromSomeAPICall</span><span class="p">();</span>

<span class="c1">// Dispatch an action containing data from above</span>
<span class="nx">dispatch</span><span class="p">(</span><span class="nx">updateSources</span><span class="p">(</span><span class="nx">newSourceList</span><span class="p">));</span>
</pre></div>
</div>
<p>We’ll often dispatch actions when users submit data, click a button, or if a websocket message is received from the back-end (more on this later) telling the front-end that the DB has been updated and it should re-fetch some data (we always want the relevant portions of the front-end state to stay in sync with the back-end DB).</p>
<p>A typical pattern you will see in SkyPortal is: make an API call (an HTTP request) to fetch data from the back-end, then dispatch an action containing the response data to update the front-end state accordingly. We’ve written a utility function in <code class="docutils literal notranslate"><span class="pre">static/js/API.js</span></code> that simplifies the process, utilizing <a class="reference external" href="https://github.com/reduxjs/redux-thunk"><em>thunks</em></a>.</p>
<p>From <a class="reference external" href="https://alligator.io/redux/redux-thunk/">https://alligator.io/redux/redux-thunk/</a>:</p>
<blockquote>
<div><p>Redux Thunk is a middleware that lets you call action creators that return a function instead of an action object. That function receives the store’s dispatch method, which is then used to dispatch regular synchronous actions inside the body of the function once the asynchronous operations have completed.</p>
</div></blockquote>
<p>The function that the action creator returns is a thunk, to which the <code class="docutils literal notranslate"><span class="pre">redux-thunk</span></code> middleware library suppies the store’s dispatch. We can then execute some statements inside the thunk, including making API calls to the back-end, and then dispatch an action containing the result. Let’s illustrate with an example. Here’s a typical SkyPortal action creator (this is a simplified version of part of the actual source code):</p>
<div class="highlight-jsx notranslate"><div class="highlight"><pre><span></span><span class="kr">import</span> <span class="o">*</span> <span class="nx">as</span> <span class="nx">API</span> <span class="nx">from</span> <span class="s1">&#39;../API&#39;</span><span class="p">;</span>


<span class="c1">// Action type</span>
<span class="kr">export</span> <span class="kr">const</span> <span class="nx">FETCH_SOURCES</span> <span class="o">=</span> <span class="s1">&#39;skyportal/FETCH_SOURCES&#39;</span><span class="p">;</span>

<span class="c1">// Action creator that returns a thunk</span>
<span class="kr">export</span> <span class="kd">function</span> <span class="nx">fetchSources</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">API</span><span class="p">.</span><span class="nx">GET</span><span class="p">(</span><span class="s1">&#39;/api/sources&#39;</span><span class="p">,</span> <span class="nx">FETCH_SOURCES</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>When we call <code class="docutils literal notranslate"><span class="pre">dispatch(fetchSources())</span></code>, the thunk returned by <code class="docutils literal notranslate"><span class="pre">API.GET</span></code> is called, which dispatches an action of type <code class="docutils literal notranslate"><span class="pre">FETCH_SOURCES</span></code>, then makes an asynchronous HTTP GET request to the back-end. If the request returns with a successful response, the response data is then packaged into another action of type “FETCH_SOURCES_OK” which is then dispatched to the store. The first action dispatched, of type <code class="docutils literal notranslate"><span class="pre">FETCH_SOURCES</span></code>, may or may not need to be handled in our reducers. In the case of SkyPortal, we do indeed handle this action and update the front-end state object <code class="docutils literal notranslate"><span class="pre">sources.queryInProgress</span></code> in our reducer. The final action dispatched, of type “FETCH_SOURCES_OK”, which contains the HTTP request response data, is also handled in our reducer, updating other portions of the <code class="docutils literal notranslate"><span class="pre">sources</span></code> branch of the app state.</p>
<p>In order for our components to access the application state, the <code class="docutils literal notranslate"><span class="pre">react-redux</span></code> library provides the <code class="docutils literal notranslate"><span class="pre">useSelector</span></code> hook:</p>
<div class="highlight-jsx notranslate"><div class="highlight"><pre><span></span><span class="kr">import</span> <span class="p">{</span> <span class="nx">useSelector</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react-redux&#39;</span><span class="p">;</span>

<span class="c1">// Accessing the application state</span>
<span class="kr">const</span> <span class="p">{</span> <span class="nx">sourceList</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">useSelector</span><span class="p">((</span><span class="nx">state</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">state</span><span class="p">.</span><span class="nx">sources</span><span class="p">);</span>
</pre></div>
</div>
<p>Now that we’ve learned a bit about the various technologies employed in the front-end, let’s learn by getting our hands dirty and add a dummy feature to SkyPortal.</p>
</div>
</div>
<div class="section" id="adding-a-new-end-to-end-skyportal-feature">
<h2>Adding a new end-to-end SkyPortal feature<a class="headerlink" href="#adding-a-new-end-to-end-skyportal-feature" title="Permalink to this headline">¶</a></h2>
<p>Now we’ll put all these pieces together and add a simple new “feature” to SkyPortal: a random number generator. We’ll add a button that makes an API call to the back-end, returning a random string, which will be stored in the front-end state and displayed on the screen.</p>
<div class="section" id="front-end">
<h3>Front-end<a class="headerlink" href="#front-end" title="Permalink to this headline">¶</a></h3>
<p>We’ll start with defining our new <code class="docutils literal notranslate"><span class="pre">RandomString</span></code> component in a new file in the components directory (<code class="docutils literal notranslate"><span class="pre">static/js/components/RandomString.jsx</span></code>):</p>
<div class="highlight-jsx notranslate"><div class="highlight"><pre><span></span><span class="kr">import</span> <span class="nx">React</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">useDispatch</span><span class="p">,</span> <span class="nx">useSelector</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react-redux&#39;</span><span class="p">;</span>

<span class="c1">// Import our action creators from `static/js/ducks/randomString.js` - see below</span>
<span class="kr">import</span> <span class="o">*</span> <span class="nx">as</span> <span class="nx">Actions</span> <span class="nx">from</span> <span class="s1">&#39;../ducks/randomString&#39;</span><span class="p">;</span>


<span class="kr">const</span> <span class="nx">RandomString</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">useSelector</span><span class="p">((</span><span class="nx">state</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">state</span><span class="p">.</span><span class="nx">randomString</span><span class="p">);</span>
  <span class="kr">const</span> <span class="nx">dispatch</span> <span class="o">=</span> <span class="nx">useDispatch</span><span class="p">();</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
        <span class="nx">Back</span><span class="o">-</span><span class="nx">end</span> <span class="nx">random</span> <span class="nx">string</span> <span class="nx">generator</span><span class="p">.</span>
        <span class="p">&lt;</span><span class="nt">br</span> <span class="p">/&gt;</span>
        <span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">dummy</span> <span class="nx">component</span> <span class="k">for</span> <span class="nx">educational</span> <span class="nx">purposes</span><span class="p">.</span>
        <span class="p">&lt;</span><span class="nt">br</span> <span class="p">/&gt;</span>
        <span class="nx">Current</span> <span class="nx">value</span> <span class="nx">is</span><span class="o">:</span> <span class="p">{</span><span class="nx">value</span><span class="p">}</span>
      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;button&quot;</span> <span class="na">onClick</span><span class="o">=</span><span class="p">{()</span> <span class="p">=&gt;</span> <span class="nx">dispatch</span><span class="p">(</span><span class="nx">Actions</span><span class="p">.</span><span class="nx">fetchRandomString</span><span class="p">())}&gt;</span>
          <span class="nx">Generate</span> <span class="k">new</span> <span class="nx">random</span> <span class="nx">string</span> <span class="nx">on</span> <span class="nx">the</span> <span class="nx">back</span><span class="o">-</span><span class="nx">end</span><span class="p">.</span>
        <span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
  <span class="p">);</span>
<span class="p">};</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">RandomString</span><span class="p">;</span>
</pre></div>
</div>
<p>Our new component can see a portion of the app state tree (specifically the <code class="docutils literal notranslate"><span class="pre">randomString</span></code> branch) via the <code class="docutils literal notranslate"><span class="pre">useSelector</span></code> hook, and can dispatch action creators via the <code class="docutils literal notranslate"><span class="pre">useDispatch</span></code> hook. The value of <code class="docutils literal notranslate"><span class="pre">state.randomString</span></code> (which is intialized to the string “null” in its associated reducer, which we’ll see shortly) is displayed, and a button is shown. We’ve supplied a handler to the button’s <code class="docutils literal notranslate"><span class="pre">onClick</span></code> event, which when called, dispatches an action creator called <code class="docutils literal notranslate"><span class="pre">fetchRandomString</span></code>. Let’s look at that action creator defined below.</p>
<p>All of the redux-related logic associated with our new component will live in a separate file in the <code class="docutils literal notranslate"><span class="pre">static/js/ducks</span></code> directory. This is where we’ll define our action types, action creators and reducer.</p>
<p><code class="docutils literal notranslate"><span class="pre">static/js/ducks/randomString.js</span></code>:</p>
<div class="highlight-jsx notranslate"><div class="highlight"><pre><span></span><span class="kr">import</span> <span class="o">*</span> <span class="nx">as</span> <span class="nx">API</span> <span class="nx">from</span> <span class="s1">&#39;../API&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">store</span> <span class="nx">from</span> <span class="s1">&#39;../store&#39;</span><span class="p">;</span>


<span class="kr">export</span> <span class="kr">const</span> <span class="nx">FETCH_RANDOM_STRING</span> <span class="o">=</span> <span class="s1">&#39;skyportal/FETCH_RANDOM_STRING&#39;</span><span class="p">;</span>
<span class="kr">export</span> <span class="kr">const</span> <span class="nx">FETCH_RANDOM_STRING_OK</span> <span class="o">=</span> <span class="s1">&#39;skyportal/FETCH_RANDOM_STRING_OK&#39;</span><span class="p">;</span>
<span class="kr">export</span> <span class="kr">const</span> <span class="nx">FETCH_RANDOM_STRING_ERROR</span> <span class="o">=</span> <span class="s1">&#39;skyportal/FETCH_RANDOM_STRING_ERROR&#39;</span><span class="p">;</span>
<span class="kr">export</span> <span class="kr">const</span> <span class="nx">FETCH_RANDOM_STRING_FAIL</span> <span class="o">=</span> <span class="s1">&#39;skyportal/FETCH_RANDOM_STRING_FAIL&#39;</span><span class="p">;</span>

<span class="kr">export</span> <span class="kd">function</span> <span class="nx">fetchRandomString</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">API</span><span class="p">.</span><span class="nx">GET</span><span class="p">(</span><span class="s1">&#39;/api/random_string&#39;</span><span class="p">,</span> <span class="nx">FETCH_RANDOM_STRING</span><span class="p">);</span>
<span class="p">}</span>

<span class="kr">const</span> <span class="nx">reducer</span> <span class="o">=</span> <span class="p">(</span><span class="nx">state</span><span class="o">=</span><span class="s2">&quot;null&quot;</span><span class="p">,</span> <span class="nx">action</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="k">switch</span> <span class="p">(</span><span class="nx">action</span><span class="p">.</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">case</span> <span class="nx">FETCH_RANDOM_STRING_OK</span><span class="o">:</span> <span class="p">{</span>
      <span class="kr">const</span> <span class="p">{</span> <span class="nx">value</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">action</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>
      <span class="k">return</span> <span class="nx">value</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">case</span> <span class="nx">FETCH_RANDOM_STRING_ERROR</span><span class="o">:</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">action</span><span class="p">.</span><span class="nx">message</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">case</span> <span class="nx">FETCH_RANDOM_STRING_FAIL</span><span class="o">:</span> <span class="p">{</span>
      <span class="k">return</span> <span class="s2">&quot;uncaught error&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">default</span><span class="o">:</span>
      <span class="k">return</span> <span class="nx">state</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="nx">store</span><span class="p">.</span><span class="nx">injectReducer</span><span class="p">(</span><span class="s1">&#39;randomString&#39;</span><span class="p">,</span> <span class="nx">reducer</span><span class="p">);</span>
</pre></div>
</div>
<p>This defines a few new action types, a new action creator (in this case, a function that returns a thunk (another function), which is what <code class="docutils literal notranslate"><span class="pre">API.GET</span></code> is), and a reducer, which, upon injecting into the store, describes how the <code class="docutils literal notranslate"><span class="pre">randomString</span></code> branch of the app state should be updated if an action of type <code class="docutils literal notranslate"><span class="pre">FETCH_RANDOM_STRING_OK</span></code> or <code class="docutils literal notranslate"><span class="pre">FETCH_RANDOM_STRING_FAIL</span></code> is received. Note that in addition to dispatching actions of type <code class="docutils literal notranslate"><span class="pre">&quot;ORIGINAL_ACTION_TYPE&quot;</span> <span class="pre">+</span> <span class="pre">&quot;_OK&quot;</span></code> upon successful completion of API calls, the <code class="docutils literal notranslate"><span class="pre">API</span></code> module functions will also dispatch actions of type <code class="docutils literal notranslate"><span class="pre">&quot;ORIGINAL_ACTION_TYPE&quot;</span> <span class="pre">+</span> <span class="pre">&quot;_FAIL&quot;</span></code> if the API call fails.</p>
<p>To render our new <code class="docutils literal notranslate"><span class="pre">RandomString</span></code> component, we can simply import it and render it in the body of any other component being rendered in our app (depending on where we want it to appear): <code class="docutils literal notranslate"><span class="pre">&lt;RandomString</span> <span class="pre">/&gt;</span></code>. If our component tooks props (like arguments), this is where we’d pass them in.</p>
</div>
<div class="section" id="back-end">
<h3>Back-end<a class="headerlink" href="#back-end" title="Permalink to this headline">¶</a></h3>
<p>Now let’s take a look at what we’ll need to add to the back-end to make our new feature work.</p>
<p>The SkyPortal back-end is built using <a class="reference external" href="https://www.tornadoweb.org/en/stable/">Tornado</a>, a Python web application framework that provides its own I/O event loop for non-blocking sockets, making it ideal for use with websockets (see below).</p>
<p>To handle HTTP requests, we define <em>request handlers</em> that are mapped to API endpoints in the application’s configuration (in <code class="docutils literal notranslate"><span class="pre">skyportal/app_server.py</span></code> – see below). Each SkyPortal request handler is a subclass of <code class="docutils literal notranslate"><span class="pre">BaseHandler</span></code> (defined in <code class="docutils literal notranslate"><span class="pre">skyportal/handlers/base.py</span></code>), a handler that extends Tornado’s base <a class="reference external" href="https://www.tornadoweb.org/en/stable/web.html#tornado.web.RequestHandler">RequestHandler</a>, handling authentication and providing utility methods for pushing websocket messages to the front-end and returning HTTP responses.</p>
<p>Let’s take a look at adding our own handler. We’ll start by defining a new request handler in a new file <code class="docutils literal notranslate"><span class="pre">skyportal/handlers/api/random_string.py</span></code>. Note that we’ve imported <code class="docutils literal notranslate"><span class="pre">BaseHandler</span></code> which serves as the base class of our new handler. We define class methods describing how to handle requests of various types, e.g. a <code class="docutils literal notranslate"><span class="pre">put</span></code> method for PUT requests, a <code class="docutils literal notranslate"><span class="pre">post</span></code> method for POST requests, etc.</p>
<p><code class="docutils literal notranslate"><span class="pre">skyportal/handlers/api/random_string.py</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">uuid</span>
<span class="kn">from</span> <span class="nn">baselayer.app.access</span> <span class="kn">import</span> <span class="n">auth_or_token</span>
<span class="kn">from</span> <span class="nn">..base</span> <span class="kn">import</span> <span class="n">BaseHandler</span>


<span class="k">class</span> <span class="nc">RandomStringHandler</span><span class="p">(</span><span class="n">BaseHandler</span><span class="p">):</span>
    <span class="nd">@auth_or_token</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())})</span>
</pre></div>
</div>
<p>The decorator <code class="docutils literal notranslate"><span class="pre">&#64;auth_or_token</span></code> tells the application that the request must come from either or a logged in user (via the browser), or must include a valid token in the request header. If neither of these are true, the request returns with an error. Note that any response data must be passed into <code class="docutils literal notranslate"><span class="pre">success</span></code> as the <code class="docutils literal notranslate"><span class="pre">data</span></code> keyword argument, and must be a dictionary. <code class="docutils literal notranslate"><span class="pre">BaseHandler.success</span></code> will then add a <code class="docutils literal notranslate"><span class="pre">version</span></code> key to this dictionary whose value is a string describing the currently running SkyPortal version, and returns a response object whose JSON body content is of the form:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;success&#39;</span><span class="p">,</span>
 <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;65cd3692-8849-42ad-982d-f5f50e233005&#39;</span><span class="p">,</span>
          <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;0.9.dev0+git20200202.d9104db&#39;</span><span class="p">}}</span>
</pre></div>
</div>
<p>(in this particular case).</p>
<p>In addition to <code class="docutils literal notranslate"><span class="pre">success</span></code>, <code class="docutils literal notranslate"><span class="pre">BaseHandler</span></code> also provides an <code class="docutils literal notranslate"><span class="pre">error</span></code> method for returning error responses:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SomeHandler</span><span class="p">(</span><span class="n">BaseHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">some_request_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="o">...</span>
        <span class="k">if</span> <span class="n">error_occurred</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Error message here&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>Error responses with informative messages should be returned when a request contains invalid data, if the user doesn’t have access to the requested resource, or if an exception is caught during the handling of the request.</p>
<p>After adding the relevant import lines to <code class="docutils literal notranslate"><span class="pre">skyportal/handlers/api/__init__.py</span></code> and <code class="docutils literal notranslate"><span class="pre">skyportal/app_server.py</span></code> to import our new <code class="docutils literal notranslate"><span class="pre">RandomStringHandler</span></code> into the <code class="docutils literal notranslate"><span class="pre">app_server</span></code> module, we then add an element to our endpoint &amp; handler mapping list (see the <code class="docutils literal notranslate"><span class="pre">handlers</span></code> assignment statement in the <code class="docutils literal notranslate"><span class="pre">make_app</span></code> function defined in <code class="docutils literal notranslate"><span class="pre">skyportal/app_server.py</span></code>) to map the associated API endpoint to the new handler class. The elements of this list are tuples consisting of a regex string describing the matching URL pattern, and the handler object: <code class="docutils literal notranslate"><span class="pre">(r'/api/random_string',</span> <span class="pre">RandomStringHandler)</span></code>. After defining our handler and mapping it to the API endpoint in our application, we can now expect any authenticated GET requests to <code class="docutils literal notranslate"><span class="pre">&lt;base_URL&gt;/api/random_string</span></code> to return with a successful response containing a new random string in the JSON body.</p>
<p>We can now fire up SkyPortal to try out our new feature by running <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">run</span></code> (run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">log</span></code> in another terminal to monitor the logs). After we see in the logs that the compiling and bundling our JavaScript sources (you’ll see “main.bundle.js”), navigate to wherever you’ve configured the app to run (localhost:5000 by default), perform a hard refresh to bypass outdated cache, and you can see our component is rendering and behaving as expected.</p>
<p>Now our new feature should be fully implemented, and we’ll add a test to make sure it’s working as expected. We use Selenium in our front-end tests; we’ll use that to make sure a UUID string appears after (and not before) we click the button. This test assumes we’ve rendered our new component inside the <code class="docutils literal notranslate"><span class="pre">Profile</span></code> component, which is rendered when a user navigates to <code class="docutils literal notranslate"><span class="pre">/profile</span></code> (this is arbitrary - adjust these to reflect whichever location you choose to render your component).</p>
<p><code class="docutils literal notranslate"><span class="pre">skyportal/tests/frontend/test_random_string.py</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pytest</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.support.ui</span> <span class="kn">import</span> <span class="n">Select</span>

<span class="k">def</span> <span class="nf">test_random_string_generator_button</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">user</span><span class="p">):</span>
    <span class="n">uuid_re_pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;[0-9a-fA-F]</span><span class="si">{8}</span><span class="s1">\-[0-9a-fA-F]</span><span class="si">{4}</span><span class="s1">\-[0-9a-fA-F]</span><span class="si">{4}</span><span class="s1">\-[0-9a-fA-F]</span><span class="si">{4}</span><span class="s1">\-[0-9a-fA-F]</span><span class="si">{12}</span><span class="s1">&#39;</span>

    <span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;/become_user/</span><span class="si">{</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;/profile&#39;</span><span class="p">)</span>

    <span class="c1"># Check that default value of &quot;null&quot; is displayed initially</span>
    <span class="n">orig_display_xpath</span> <span class="o">=</span> <span class="s1">&#39;//div[contains(.,&quot;Current value is: null&quot;)]&#39;</span>
    <span class="n">display_div</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">wait_for_xpath</span><span class="p">(</span><span class="n">orig_display_xpath</span><span class="p">)</span>
    <span class="c1"># Check that no UUID string is displayed before we click the button</span>
    <span class="k">assert</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">uuid_re_pattern</span><span class="p">,</span> <span class="n">display_div</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
    <span class="n">btn</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">wait_for_xpath</span><span class="p">(</span><span class="s1">&#39;//button[contains(.,&quot;Generate new random string&quot;)]&#39;</span><span class="p">)</span>
    <span class="n">btn</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
    <span class="c1"># Check that the original &quot;null&quot; value is no longer displayed after button click</span>
    <span class="n">driver</span><span class="o">.</span><span class="n">wait_for_xpath_to_disappear</span><span class="p">(</span><span class="n">orig_display_xpath</span><span class="p">)</span>
    <span class="c1"># Check that a UUID string is displayed after button click</span>
    <span class="k">assert</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">uuid_re_pattern</span><span class="p">,</span> <span class="n">display_div</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
<p>Execute the test suite with <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">test</span></code>, or, to run the new test on its own, run the app in testing mode with <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">run_testing</span></code> and run <code class="docutils literal notranslate"><span class="pre">py.test</span> <span class="pre">skyportal/tests/frontend/test_random_string.py</span></code> in another terminal.</p>
</div>
<div class="section" id="websockets">
<h3>Websockets<a class="headerlink" href="#websockets" title="Permalink to this headline">¶</a></h3>
<p>SkyPortal utilizes <a class="reference external" href="http://cesium-ml.org/blog/2016/07/13/a-pattern-for-websockets-in-python/">websockets</a> for pushing messages from the back-end to the front-end. Websockets can be used for telling the front-end that a long-running job has finished, that the DB state has changed and should be re-fetched, for displaying notifications, etc. In SkyPortal, websocket messages are pushed from within the body of request handlers, and always contain an <em>action type</em>. When a message is received by the front-end, its action type is used to determine how to handle the message, which typically involves dispatching actions that update the state. For example, when a new comment is added to a source, we want the comment to automatically appear in the comments section if a user is currently viewing that source. To do this, <code class="docutils literal notranslate"><span class="pre">CommentHandler.post</span></code> pushes a websocket message to all active sessions with an action type of “skyportal/REFRESH_SOURCE” and a payload containing the source ID:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">...</span>

<span class="k">class</span> <span class="nc">CommentHandler</span><span class="p">(</span><span class="n">BaseHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">post</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="o">...</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">push_all</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s1">&#39;skyportal/REFRESH_SOURCE&#39;</span><span class="p">,</span>
                      <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;obj_id&#39;</span><span class="p">:</span> <span class="n">comment</span><span class="o">.</span><span class="n">obj_id</span><span class="p">})</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">BaseHandler</span></code> also provides a <code class="docutils literal notranslate"><span class="pre">push</span></code> method for pushing a websocket message to only the current user (the user initiating the request currently being handled).</p>
<p>Let’s turn for a moment to how these websocket messages are handled by the front-end. The <code class="docutils literal notranslate"><span class="pre">baselayer</span></code> submodule provides a <code class="docutils literal notranslate"><span class="pre">messageHandler</span></code> object that handles all incoming websocket messages, with handlers for a few action types (e.g. displaying browser notifications) already defined. To handle messages with other action types, we need to call <code class="docutils literal notranslate"><span class="pre">messageHandler.add</span></code> and pass in a function that describes how to handle those messages. Let’s look at the front-end websocket message handler associated with the above “skyportal/REFRESH_SOURCE” example:</p>
<p><code class="docutils literal notranslate"><span class="pre">static/js/ducks/source.js</span></code></p>
<div class="highlight-jsx notranslate"><div class="highlight"><pre><span></span><span class="kr">import</span> <span class="nx">messageHandler</span> <span class="nx">from</span> <span class="s1">&#39;baselayer/MessageHandler&#39;</span><span class="p">;</span>

<span class="p">...</span>

<span class="kr">export</span> <span class="kr">const</span> <span class="nx">REFRESH_SOURCE</span> <span class="o">=</span> <span class="s1">&#39;skyportal/REFRESH_SOURCE&#39;</span><span class="p">;</span>

<span class="p">...</span>

<span class="kr">export</span> <span class="kd">function</span> <span class="nx">fetchSource</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">API</span><span class="p">.</span><span class="nx">GET</span><span class="p">(</span><span class="sb">`/api/sources/</span><span class="si">${</span><span class="nx">id</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span> <span class="nx">FETCH_LOADED_SOURCE</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Websocket message handler</span>
<span class="nx">messageHandler</span><span class="p">.</span><span class="nx">add</span><span class="p">((</span><span class="nx">actionType</span><span class="p">,</span> <span class="nx">payload</span><span class="p">,</span> <span class="nx">dispatch</span><span class="p">,</span> <span class="nx">getState</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="p">{</span> <span class="nx">source</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">getState</span><span class="p">();</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">actionType</span> <span class="o">===</span> <span class="nx">REFRESH_SOURCE</span><span class="p">)</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">loaded_obj_id</span> <span class="o">=</span> <span class="nx">source</span> <span class="o">?</span> <span class="nx">source</span><span class="p">.</span><span class="nx">id</span> <span class="o">:</span> <span class="kc">null</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">loaded_obj_id</span> <span class="o">===</span> <span class="nx">payload</span><span class="p">.</span><span class="nx">obj_id</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">dispatch</span><span class="p">(</span><span class="nx">fetchSource</span><span class="p">(</span><span class="nx">loaded_obj_id</span><span class="p">));</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span>
<span class="p">...</span>
</pre></div>
</div>
<p>Our handler must be a function with the same signature as above (<code class="docutils literal notranslate"><span class="pre">getState</span></code>, a function that returns the application state, is optional and can be omitted if your handler doesn’t need to access the state). Each handler added to the <code class="docutils literal notranslate"><span class="pre">messageHandler</span></code> will be called on all incoming messages. In this case, if the message has an action type equal to “skyportal/REFRESH_SOURCE”, we check whether the user is currently viewing the source whose ID matches that provided in the message’s payload (if a user is currently viewing a source, <code class="docutils literal notranslate"><span class="pre">state.source.id</span></code> will contain that source’s ID), and if so, we dispatch an action creator that will re-fetch the source data and update the state accordingly.</p>
<p>By using websocket messages whenever the back-end state has changed, in conjuction with the automatic re-rendering capabilities of React, we ensure that any changes to the DB state are automatically reflected by real time updates to the front-end view.</p>
<p>In addition to <code class="docutils literal notranslate"><span class="pre">BaseHandler.push</span></code> and <code class="docutils literal notranslate"><span class="pre">BaseHandler.push_all</span></code>, an optional <code class="docutils literal notranslate"><span class="pre">action</span></code> keyword argument (and corresponding <code class="docutils literal notranslate"><span class="pre">payload</span></code> keywoard argument, if relevant) can be supplied to <code class="docutils literal notranslate"><span class="pre">BaseHandler.success</span></code>, and a websocket message with that action type (and payload, if provided) will be pushed to the current user. For example,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SomeHandler</span><span class="p">(</span><span class="n">BaseHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">some_request_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="o">...</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="o">...</span><span class="p">},</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;skyportal/ACTION_TYPE&quot;</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="o">...</span><span class="p">})</span>
</pre></div>
</div>
<p>is just a more compact form of the following, which is equivalent:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SomeHandler</span><span class="p">(</span><span class="n">BaseHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">some_request_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="o">...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s2">&quot;skyportal/ACTION_TYPE&quot;</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="o">...</span><span class="p">})</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="o">...</span><span class="p">})</span>
</pre></div>
</div>
<p>Note that whenever a message should be pushed to <em>all</em> active users, <code class="docutils literal notranslate"><span class="pre">BaseHandler.push_all</span></code> must be used:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SomeHandler</span><span class="p">(</span><span class="n">BaseHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">some_request_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="o">...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_all</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s2">&quot;skyportal/ACTION_TYPE&quot;</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="o">...</span><span class="p">})</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="o">...</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="file-creation-edit-bookkeeping">
<h3>File creation/edit bookkeeping<a class="headerlink" href="#file-creation-edit-bookkeeping" title="Permalink to this headline">¶</a></h3>
<p>Let’s recap the files we’ve created or edited to implement this new feature:</p>
<ul class="simple">
<li><p>component definition file <code class="docutils literal notranslate"><span class="pre">static/js/components/RandomString.jsx</span></code> <em>(new)</em></p></li>
<li><p>Redux-related code (action creators, reducer, etc.) <code class="docutils literal notranslate"><span class="pre">static/js/ducks/randomString.js</span></code> <em>(new)</em></p></li>
<li><p>importing our new component and rendering it in a component that’s already being rendered <em>(2 lines of code)</em></p></li>
<li><p>back-end handler definition in <code class="docutils literal notranslate"><span class="pre">skyportal/handlers/api/random_string.py</span></code> <em>(new)</em></p></li>
<li><p>importing our handler and adding the route mapping to our handlers list in <code class="docutils literal notranslate"><span class="pre">skyportal/app_server.py</span></code> <em>(2 lines of code)</em></p></li>
<li><p>adding a new test in <code class="docutils literal notranslate"><span class="pre">skyportal/tests/frontend/test_random_string.py</span></code> <em>(new)</em></p></li>
</ul>
</div>
</div>
<div class="section" id="summary-of-front-end-data-flow">
<h2>Summary of front-end data flow<a class="headerlink" href="#summary-of-front-end-data-flow" title="Permalink to this headline">¶</a></h2>
<p>For a summary of the flow of data in the application’s front-end, see the following diagram:</p>
<p><img alt="Frontend architecture" src="_images/frontend.png" /></p>
<p>The global front-end application state is stored in the Redux store as a dictionary. This can only be updated by dispatching actions to the store, which are passed to reducers that determine how to update the application state based on the type and contents of the action. The React components describe the appearance and behavior of the UI components, and are connected to the store’s state and dispatch via the <code class="docutils literal notranslate"><span class="pre">useSelector</span></code> and <code class="docutils literal notranslate"><span class="pre">useDispatch</span></code> hooks provided by the <code class="docutils literal notranslate"><span class="pre">react-redux</span></code> library. Components are automatically re-rendered by React when any part of the state tree upon which they depend is updated. User interaction with these components (e.g. clicking a button) can dispatch action creators, which may make API calls and dispatch actions that will lead to the app state being updated. Messages dispatched from the back-end via websockets can also trigger actions that lead to the app state being updated.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="contributing.html" class="btn btn-neutral float-left" title="How to Contribute" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2017, The skyportal Team

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>