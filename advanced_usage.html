<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="How to work with photometric series" href="photometric_series.html" /><link rel="prev" title="Spatial Catalogs" href="spatial_catalog.html" />

    <!-- Generated with Sphinx 8.0.2 and Furo 2024.08.06 -->
        <title>Advanced usage - skyportal 0.9.dev0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="_static/output_cells.css?v=4c393c42" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">skyportal 0.9.dev0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">skyportal 0.9.dev0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="design.html">System Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="setup.html">Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev.html">Developer notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="deploy.html">Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_loader.html">Data loader</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">How to Contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="adding_features.html">Adding new features</a></li>
<li class="toctree-l1"><a class="reference internal" href="adding_comments_annotation_types.html">Adding a new type of Comment or Annotation</a></li>
<li class="toctree-l1"><a class="reference internal" href="styling.html">Styling components</a></li>
<li class="toctree-l1"><a class="reference internal" href="database.html">Database Schema</a></li>
<li class="toctree-l1"><a class="reference internal" href="migrations.html">Database migrations</a></li>
<li class="toctree-l1"><a class="reference internal" href="query_analysis.html">Analyzing database queries</a></li>
<li class="toctree-l1"><a class="reference internal" href="permissions.html">Access controls</a></li>
<li class="toctree-l1"><a class="reference internal" href="slack.html">Slack Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="followup.html">Follow-up triggering</a></li>
<li class="toctree-l1"><a class="reference internal" href="mma.html">MMA Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="period.html">Periodic Timeseries Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="spatial_catalog.html">Spatial Catalogs</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Advanced usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="photometric_series.html">How to work with photometric series</a></li>
<li class="toctree-l1"><a class="reference internal" href="analysis.html">Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="extensions.html">SkyPortal Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="pages.html">Front-end Pages</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          

<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="advanced-usage">
<h1>Advanced usage<a class="headerlink" href="#advanced-usage" title="Link to this heading">¶</a></h1>
<section id="posting-color-magnitude-data-to-generate-an-hr-diagram">
<h2>Posting color-magnitude data to generate an HR diagram<a class="headerlink" href="#posting-color-magnitude-data-to-generate-an-hr-diagram" title="Link to this heading">¶</a></h2>
<p>For stellar targets we are interested in showing the HR diagram
based on the color-magnitude data from a cross match to, e.g., the Gaia catalog.
Currently we support only Gaia inputs on the front-end,
but in a future release we may expand the notion of the HR diagram
to arbitrary catalogs.</p>
<p>This is done by posting an <code class="docutils literal notranslate"><span class="pre">Annotation</span></code> to the source, with correctly formatted data.
If at least one properly formatted <code class="docutils literal notranslate"><span class="pre">Annotation</span></code> with Gaia color-magnitude data
exists on the source, an HR diagram will be rendered for it.</p>
<p>First let’s see how to post an <code class="docutils literal notranslate"><span class="pre">Annotation</span></code> using the <code class="docutils literal notranslate"><span class="pre">requests</span></code> package.
Here is a working example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://localhost:5000&#39;</span>
<span class="n">token</span> <span class="o">=</span> <span class="s1">&#39;239868fa-8307-41ad-983f-4a8180609df6&#39;</span>
<span class="n">header</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Authorization&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;token </span><span class="si">{</span><span class="n">token</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;content_type&quot;</span><span class="p">:</span> <span class="s2">&quot;application/json&quot;</span><span class="p">}</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;obj_id&#39;</span><span class="p">:</span> <span class="s1">&#39;2021example&#39;</span><span class="p">,</span>
        <span class="s1">&#39;origin&#39;</span><span class="p">:</span> <span class="s1">&#39;cross_match_robot&#39;</span><span class="p">,</span>
        <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;Gaia&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;Mag_G&#39;</span><span class="p">,</span> <span class="mf">10.2</span><span class="p">,</span>
                <span class="s1">&#39;Mag_Bp&#39;</span><span class="p">:</span> <span class="mf">9.8</span><span class="p">,</span>
                <span class="s1">&#39;Mag_Rp&#39;</span><span class="p">:</span> <span class="mf">10.5</span><span class="p">,</span>
                <span class="s1">&#39;Plx&#39;</span><span class="p">:</span> <span class="mf">8.5</span>
               <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
      <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s1">/api/sources/2021example/annotations&#39;</span><span class="p">,</span>
      <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span>
      <span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>Let’s look at this line by line.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">url</span></code> should point to the SkyPortal instance,
in this case running on a local machine.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">token</span></code> should be generated for your user
through the profile page.
The token must have the ACL to annotate.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">header</span></code> is used to pass along the SkyPortal authentication token.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">data</span></code> field is a dictionary that contains
information to be posted to the database.
In this case the data must be formatted
to comply with the <code class="docutils literal notranslate"><span class="pre">Annotation</span></code> API,
namely it must have a valid <code class="docutils literal notranslate"><span class="pre">obj_id</span></code>
of an existing object that is accessible to the user,
it must contain a non-empty string for the <code class="docutils literal notranslate"><span class="pre">origin</span></code>
and it should contain the annotation <code class="docutils literal notranslate"><span class="pre">data</span></code>,
that is a dictionary with arbitrary entries.</p>
<p>In general, the <code class="docutils literal notranslate"><span class="pre">origin</span></code> field is used to
enumerate the different services that would
annotate each source.
Each origin can only post a single <code class="docutils literal notranslate"><span class="pre">Annotation</span></code>
to each source, but that <code class="docutils literal notranslate"><span class="pre">Annotation</span></code> can contain arbitrary data.</p>
<p>In the case of the color-magnitude plot,
the system only recognizes annotations
with a specific schema:</p>
<ul class="simple">
<li><p>One of the keys in the annotation <code class="docutils literal notranslate"><span class="pre">data</span></code> must be named <code class="docutils literal notranslate"><span class="pre">Gaia</span></code>.</p></li>
<li><p>The value of that key must be another dictionary.</p></li>
<li><p>That dictionary must contain the following entries:</p></li>
<li><p>‘Mag_G’, ‘Mag_Bp’, ‘Mag_Rp’, ‘Plx’.</p></li>
<li><p>All these names (including the catalog name) may be made customizable
in a future release. Currently, the HR diagram is drawn only for Gaia data.</p></li>
<li><p>The names are searched ignoring case, and removing underscores.
So, for example, the dictionary can contain <code class="docutils literal notranslate"><span class="pre">mag_g</span></code> or <code class="docutils literal notranslate"><span class="pre">MagG</span></code>,
and would still be accepted as data for an HR diagram.
Please do not include multiple data keys with indistinguishable names,
i.e., both <code class="docutils literal notranslate"><span class="pre">mag_g</span></code> and <code class="docutils literal notranslate"><span class="pre">Mag_G</span></code> in the same <code class="docutils literal notranslate"><span class="pre">Annotation</span></code> as this will
cause undefined behavior.</p></li>
<li><p>The parallax (”Plx”) is given in units of milli-arcsec.</p></li>
</ul>
<p>Finally, the return value <code class="docutils literal notranslate"><span class="pre">response</span></code> from the request
should contain a <code class="docutils literal notranslate"><span class="pre">status==200</span></code> and a data dictionary
with the data that was posted.
If the posting was unsuccessful,
the status would be 400.</p>
</section>
<section id="managing-taxonomies">
<h2>Managing Taxonomies<a class="headerlink" href="#managing-taxonomies" title="Link to this heading">¶</a></h2>
<p>Taxonomies are used for classification. There is typically a sitewide taxonomy that all users of SkyPortal can see. By default, we seed a new SP database with the latest taxonomy from the <a class="reference external" href="https://github.com/profjsb/timedomain-taxonomy">Time-domain Astronomy Taxonomy
(Github)</a> (<code class="docutils literal notranslate"><span class="pre">tdtax</span></code>). From time to time, the latest taxonomy may be upgraded as new subclasses of sources are discovered and SP admins may need to push a new version of the taxonomy to the live application.</p>
<section id="upgrading-the-sitewide-taxonomy">
<h3>Upgrading the Sitewide Taxonomy<a class="headerlink" href="#upgrading-the-sitewide-taxonomy" title="Link to this heading">¶</a></h3>
<p>To upgrade to the latest <code class="docutils literal notranslate"><span class="pre">tdtax</span></code>, as an admin, you will need to generate a token with a “Post taxonomy” ACL. Next install the latest <code class="docutils literal notranslate"><span class="pre">tdtax</span></code> on your system:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">U</span> <span class="n">tdtax</span>
</pre></div>
</div>
<p>Next, in Python:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">tdtax</span>

<span class="n">tax_obj</span> <span class="o">=</span>  <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Sitewide Taxonomy&#39;</span><span class="p">,</span>
            <span class="s1">&#39;provenance&#39;</span><span class="p">:</span> <span class="s1">&#39;https://github.com/profjsb/timedomain-taxonomy&#39;</span><span class="p">,</span>
            <span class="s1">&#39;hierarchy&#39;</span><span class="p">:</span> <span class="n">tdtax</span><span class="o">.</span><span class="n">taxonomy</span><span class="p">,</span>
            <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">tdtax</span><span class="o">.</span><span class="n">__version__</span><span class="p">),</span>
<span class="p">}</span>

<span class="n">token</span> <span class="o">=</span> <span class="s2">&quot;USE-YOUR-TOKEN-HERE&quot;</span>
<span class="k">def</span> <span class="nf">api</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">endpoint</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Authorization&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;token </span><span class="si">{</span><span class="n">token</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">}</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">endpoint</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">api</span><span class="p">(</span><span class="s1">&#39;POST&#39;</span><span class="p">,</span>
               <span class="s1">&#39;URL_TO_SKYPORTAL_INSTANCE/api/taxonomy&#39;</span><span class="p">,</span>
                <span class="n">data</span><span class="o">=</span><span class="n">tax_obj</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">())</span>
</pre></div>
</div>
<p>You should then see something like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;success&#39;</span><span class="p">,</span>
 <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;taxonomy_id&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">},</span>
 <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;0.9.dev0+git...&#39;</span><span class="p">}</span>
</pre></div>
</div>
<p>If the <code class="docutils literal notranslate"><span class="pre">name</span></code> of the taxonomy is exactly the same as a taxonomy already in the system, this new taxonomy will supercede that taxonomy. That is, by default it will be set to be the latest version (<code class="docutils literal notranslate"><span class="pre">IsLatest</span> <span class="pre">=</span> <span class="pre">True</span></code>) and shown to end users in the dropdown menu on the Source page. Older classifications will be still associated with the <code class="docutils literal notranslate"><span class="pre">taxonomy_id</span></code> they were originally connected to.</p>
</section>
<section id="posting-a-new-taxonomy">
<h3>Posting a New Taxonomy<a class="headerlink" href="#posting-a-new-taxonomy" title="Link to this heading">¶</a></h3>
<p>You may wish to post a new custom taxonomy, for example to enable classifications that are outside the scope of the sitewide taxonomy. When posting a new taxonomy, it is usually preferable to limit its availability to specific, relevant groups. In this way, you can assign your own classifications where needed without extending them across the entire site.</p>
<p>To post a new taxonomy to specific groups, follow the instructions above, but add the <code class="docutils literal notranslate"><span class="pre">group_ids</span></code> parameter (containing the array of group ids to receive the taxonomy) to <code class="docutils literal notranslate"><span class="pre">tax_obj</span></code>. Ensure your new taxonomy is in a nested JSON format.</p>
<p>Once the taxonomy is posted, users who are members of the specified groups will be able to see and use the new classifications. To add the taxonomy to another group, perform another <code class="docutils literal notranslate"><span class="pre">POST</span></code> request containing the desired group id.</p>
</section>
<section id="note-deleting-a-taxonomy">
<h3>NOTE: Deleting a Taxonomy<a class="headerlink" href="#note-deleting-a-taxonomy" title="Link to this heading">¶</a></h3>
<p>In very rare cases you may wish to delete a taxonomy (e.g., if you made a typo when loading it). This should be done with extreme care: if anyone has classifications associated with that taxonomy their classifications will be lost upon delete.</p>
</section>
</section>
<section id="spectroscopic-lines">
<h2>Spectroscopic lines<a class="headerlink" href="#spectroscopic-lines" title="Link to this heading">¶</a></h2>
<p>The selection of element and galaxy lines on SkyPortal were derived from the NIST atomic database (<a class="reference external" href="https://www.nist.gov/pml/atomic-spectra-database">https://www.nist.gov/pml/atomic-spectra-database</a>) , using the methods of Gal-Yam (2019) (<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2019ApJ...882..102G/abstract">https://ui.adsabs.harvard.edu/abs/2019ApJ…882..102G/abstract</a>). Telluric and Skylines were migrated from the ZTF Marshal.
Element lines and galaxy lines move according to the set redshift or expansion velocity. Tellurics and skylines remain static.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="photometric_series.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">How to work with photometric series</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="spatial_catalog.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Spatial Catalogs</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2020–2023, The SkyPortal Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Advanced usage</a><ul>
<li><a class="reference internal" href="#posting-color-magnitude-data-to-generate-an-hr-diagram">Posting color-magnitude data to generate an HR diagram</a></li>
<li><a class="reference internal" href="#managing-taxonomies">Managing Taxonomies</a><ul>
<li><a class="reference internal" href="#upgrading-the-sitewide-taxonomy">Upgrading the Sitewide Taxonomy</a></li>
<li><a class="reference internal" href="#posting-a-new-taxonomy">Posting a New Taxonomy</a></li>
<li><a class="reference internal" href="#note-deleting-a-taxonomy">NOTE: Deleting a Taxonomy</a></li>
</ul>
</li>
<li><a class="reference internal" href="#spectroscopic-lines">Spectroscopic lines</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=efa42bf3"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    </body>
</html>