

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Setup &mdash; skyportal 0.9.dev0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/output_cells.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Usage" href="usage.html" />
    <link rel="prev" title="About" href="about.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> skyportal
          

          
          </a>

          
            
            
              <div class="version">
                0.9.dev0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="about.html">About</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Setup</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#dependencies">Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="#source-download-python-environment">Source download, Python environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installation-macos">Installation: MacOS</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installation-debian-based-linux">Installation: Debian-based Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="#launch">Launch</a></li>
<li class="toctree-l2"><a class="reference internal" href="#additional-configuration">Additional Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#authentication">Authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="#creating-an-administrative-user">Creating an administrative user</a></li>
<li class="toctree-l3"><a class="reference internal" href="#test-data">Test data</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev.html">Developer notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="deploy.html">Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_loader.html">Data loader</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">How to Contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="adding_features.html">Adding new features</a></li>
<li class="toctree-l1"><a class="reference internal" href="styling.html">Styling components</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">skyportal</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Setup</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="setup">
<h1>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h1>
<div class="section" id="dependencies">
<h2>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this headline">¶</a></h2>
<p>SkyPortal requires the following software to be installed.  We show
how to install them on MacOS and Debian-based systems below.</p>
<ul class="simple">
<li><p>Python 3.6 or later</p></li>
<li><p>Supervisor (v&gt;=3.0b2)</p></li>
<li><p>NGINX (v&gt;=1.7)</p></li>
<li><p>PostgreSQL (v&gt;=9.6)</p></li>
<li><p>Node.JS/npm (v&gt;=5.8.0)</p></li>
</ul>
</div>
<div class="section" id="source-download-python-environment">
<h2>Source download, Python environment<a class="headerlink" href="#source-download-python-environment" title="Permalink to this headline">¶</a></h2>
<p>Clone the <a class="reference external" href="https://github.com/skyportal/skyportal">SkyPortal repository</a> and start a new
virtual environment.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">skyportal</span><span class="o">/</span><span class="n">skyportal</span><span class="o">.</span><span class="n">git</span>
<span class="n">cd</span> <span class="n">skyportal</span><span class="o">/</span>
<span class="n">virtualenv</span> <span class="n">skyportal_env</span>
<span class="n">source</span> <span class="n">skyportal_env</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">activate</span>
</pre></div>
</div>
<p>(You can also use <code class="docutils literal notranslate"><span class="pre">conda</span></code> or <code class="docutils literal notranslate"><span class="pre">pipenv</span></code> to create your environment.)</p>
</div>
<div class="section" id="installation-macos">
<h2>Installation: MacOS<a class="headerlink" href="#installation-macos" title="Permalink to this headline">¶</a></h2>
<p>These instructions assume that you have <a class="reference external" href="http://brew.sh/">Homebrew</a> installed.</p>
<ol class="simple">
<li><p>Install dependencies</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brew</span> <span class="n">install</span> <span class="n">supervisor</span> <span class="n">nginx</span> <span class="n">postgresql</span> <span class="n">node</span>
</pre></div>
</div>
<ol class="simple">
<li><p>Start the PostgreSQL server:</p></li>
</ol>
<ul class="simple">
<li><p>To start automatically at login: <code class="docutils literal notranslate"><span class="pre">brew</span> <span class="pre">services</span> <span class="pre">start</span> <span class="pre">postgresql</span></code></p></li>
<li><p>To start manually: <code class="docutils literal notranslate"><span class="pre">pg_ctl</span> <span class="pre">-D</span> <span class="pre">/usr/local/var/postgres</span> <span class="pre">start</span></code></p></li>
</ul>
<ol class="simple">
<li><p>To run the test suite, you’ll need Geckodriver:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brew</span> <span class="n">install</span> <span class="n">geckodriver</span>
</pre></div>
</div>
</div>
<div class="section" id="installation-debian-based-linux">
<h2>Installation: Debian-based Linux<a class="headerlink" href="#installation-debian-based-linux" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>Install dependencies</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">nginx</span> <span class="n">supervisor</span> <span class="n">postgresql</span> <span class="n">libpq</span><span class="o">-</span><span class="n">dev</span> <span class="n">nodejs</span>
</pre></div>
</div>
<ol class="simple">
<li><p>Configure your database permissions.</p></li>
</ol>
<p>In <code class="docutils literal notranslate"><span class="pre">pg_hba.conf</span></code> (typically located in
<code class="docutils literal notranslate"><span class="pre">/etc/postgresql/&lt;postgres-version&gt;/main</span></code>), insert the following lines
<em>before</em> any other <code class="docutils literal notranslate"><span class="pre">host</span></code> lines:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">host</span> <span class="n">skyportal</span> <span class="n">skyportal</span> <span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="o">/</span><span class="mi">32</span> <span class="n">trust</span>
<span class="n">host</span> <span class="n">skyportal_test</span> <span class="n">skyportal</span> <span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="o">/</span><span class="mi">32</span> <span class="n">trust</span>
</pre></div>
</div>
<p>In some PostgreSQL installations, the default TCP port may be different from the 5432 value assumed in our default configuration file values. To remedy this, you can either edit your config.yaml file to reflect your system’s PostgreSQL default port, or update your system-wide config to use port 5432 by editing /etc/postgresql/12/main/postgresql.conf (replace “12” with your installed version number) and changing the line <code class="docutils literal notranslate"><span class="pre">port</span> <span class="pre">=</span> <span class="pre">XXXX</span></code> (where “XXXX” is whatever the system default was) to <code class="docutils literal notranslate"><span class="pre">port</span> <span class="pre">=</span> <span class="pre">5432</span></code>.</p>
<p>Restart PostgreSQL:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">service</span> <span class="n">postgresql</span> <span class="n">restart</span>
</pre></div>
</div>
<ol class="simple">
<li><p>To run the test suite, you’ll need Geckodriver:</p></li>
</ol>
<ul class="simple">
<li><p>Download the latest version from https://github.com/mozilla/geckodriver/releases/</p></li>
<li><p>Extract the binary to somewhere on your path</p></li>
<li><p>Ensure it runs with <code class="docutils literal notranslate"><span class="pre">geckodriver</span> <span class="pre">--version</span></code></p></li>
</ul>
</div>
<div class="section" id="launch">
<h2>Launch<a class="headerlink" href="#launch" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>Initialize the database with <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">db_init</span></code> (this only needs to
happen once).</p></li>
<li><p>Copy <code class="docutils literal notranslate"><span class="pre">config.yaml.defaults</span></code> to <code class="docutils literal notranslate"><span class="pre">config.yaml</span></code>.</p></li>
<li><p>If you want some test data to play with, run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">load_demo_data</span></code>.</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">log</span></code> to monitor the service and, in a separate window, <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">run</span></code> to start the server.</p></li>
</ol>
<p>Direct your browser to http://localhost:5000.</p>
</div>
<div class="section" id="additional-configuration">
<h2>Additional Configuration<a class="headerlink" href="#additional-configuration" title="Permalink to this headline">¶</a></h2>
<p>The configuration file lives in <code class="docutils literal notranslate"><span class="pre">config.yaml</span></code>, and is meant to be
self-documenting.  Please modify as you see fit.</p>
<p><strong>Before deploying this on a public server</strong> change <code class="docutils literal notranslate"><span class="pre">app:secret-key</span></code>
to a unique value.</p>
<p>If you want to use a different configuration file, you may launch any
of the SkyPortal commands with the FLAGS environment variable set:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">FLAGS</span><span class="o">=</span><span class="s2">&quot;--config=myconfig.yaml&quot;</span> <span class="n">make</span> <span class="n">run</span>
</pre></div>
</div>
<div class="section" id="authentication">
<h3>Authentication<a class="headerlink" href="#authentication" title="Permalink to this headline">¶</a></h3>
<p>By default, the server allows anyone to log in (even if it presents a
login screen).  If you are running a public-facing instance of
SkyPortal, you should enable multi-user login by adding Google
credentials to the <code class="docutils literal notranslate"><span class="pre">server:auth</span></code> section of the configuration file.</p>
</div>
<div class="section" id="creating-an-administrative-user">
<h3>Creating an administrative user<a class="headerlink" href="#creating-an-administrative-user" title="Permalink to this headline">¶</a></h3>
<p>By default, no user has permission to perform system administration.
You can add a user with such permissions by running the following from
Python:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">skyportal.model_util</span> <span class="kn">import</span> <span class="n">make_super_user</span>
<span class="n">make_super_user</span><span class="p">(</span><span class="s1">&#39;your@email.address.org&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="test-data">
<h3>Test data<a class="headerlink" href="#test-data" title="Permalink to this headline">¶</a></h3>
<p>By default, SkyPortal contains no data.  You can ingest some sample light curves by running</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="n">load_demo_data</span>
</pre></div>
</div>
<p>This also adds <code class="docutils literal notranslate"><span class="pre">testuser&#64;cesium-ml.org</span></code> as an administrator.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="usage.html" class="btn btn-neutral float-right" title="Usage" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="about.html" class="btn btn-neutral float-left" title="About" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2017, The skyportal Team

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>